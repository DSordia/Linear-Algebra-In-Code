{% extends 'laic_app/lecturebase.html' %}

{% block video %}
    <iframe width="560" height="315"
        src="https://www.youtube.com/embed/osh80YCg_GM"
        frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
    </iframe>
{% endblock video %}

{% block keyIdeas %}
    <li>Recall the key equation from the previous lecture: P = A(A<sup>T</sup>A)<sup>-1</sup>A<sup>T</sup></li>
    <li>If b is in the column space, then Pb = b</li>
    <li>If b is perpendicular to the column space, then Pb = 0 (since it is then in the left nullspace)</li>
    <li>When Ax = b can't be solved, a line of best fit is generated where the points on that line are p, and there
        is some error e between p and b, which implies b = p + e
    </li>
    <li>As shown in the previous code section, when Ax = b can't be solved, multiplying both sides by A<sup>T</sup>
    generates the closest/best x; A<sup>T</sup>Ax&#770 = A<sup>T</sup>b and then P = Ax&#770</li>
    <li>If A has all independent columns, then A<sup>T</sup>A is invertible</li>
    <li>Columns that are perpendicular are always independent</li>
    <li>Perpendicular unit vectors (vectors with length 1) are orthonormal vectors</li>
{% endblock keyIdeas %}

{% block inCode %}
    <li>Finding the error vector e from the solution found in the previous lecture and showing that b = p + e</li>
    <li>Show that p and e are orthogonal</li>
{% endblock inCode %}

{% block code %}
    <div id="highlighterMainDiv_822255" class="syntaxhighlighter nogutter python"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td>&nbsp;</td></tr><tr><td id="codeContainer_822255" class="code"><div id="container_822255" class="container"><div id="codeline" class="line number1 index0 alt2"><code class="python comments"># LECTURE 16 - Projection Matrices and Least Squares</code></div><div id="codeline" class="line number2 index1 alt1">&nbsp;</div><div id="codeline" class="line number3 index2 alt2"><code class="python keyword">import</code> <code class="python plain">numpy as np</code></div><div id="codeline" class="line number4 index3 alt1">&nbsp;</div><div id="codeline" class="line number5 index4 alt2"><code class="python comments"># Finding the error vector e from the solution found in the previous lecture and showing that b = p + e</code></div><div id="codeline" class="line number6 index5 alt1">&nbsp;</div><div id="codeline" class="line number7 index6 alt2"><code class="python comments"># recall from the previous lecture, we have that x = [2/3, 1/2] for Ax = b, so the best line is y = 2/3 + 1/2t</code></div><div id="codeline" class="line number8 index7 alt1">&nbsp;</div><div id="codeline" class="line number9 index8 alt2"><code class="python plain">tvalues </code><code class="python keyword">=</code> <code class="python plain">[</code><code class="python value">1</code><code class="python plain">, </code><code class="python value">2</code><code class="python plain">, </code><code class="python value">3</code><code class="python plain">]</code></div><div id="codeline" class="line number10 index9 alt1"><code class="python plain">b </code><code class="python keyword">=</code> <code class="python plain">[</code><code class="python value">1</code><code class="python plain">, </code><code class="python value">2</code><code class="python plain">, </code><code class="python value">2</code><code class="python plain">]</code></div><div id="codeline" class="line number11 index10 alt2"><code class="python plain">C </code><code class="python keyword">=</code> <code class="python value">2</code><code class="python keyword">/</code><code class="python value">3</code><code class="python plain">; D </code><code class="python keyword">=</code> <code class="python value">1</code><code class="python keyword">/</code><code class="python value">2</code></div><div id="codeline" class="line number12 index11 alt1">&nbsp;</div><div id="codeline" class="line number13 index12 alt2"><code class="python plain">pvalues </code><code class="python keyword">=</code> <code class="python plain">[]; errors </code><code class="python keyword">=</code> <code class="python plain">[]</code></div><div id="codeline" class="line number14 index13 alt1">&nbsp;</div><div id="codeline" class="line number15 index14 alt2"><code class="python functions">print</code><code class="python plain">(</code><code class="python string">'p + e = b?'</code><code class="python plain">)</code></div><div id="codeline" class="line number16 index15 alt1"><code class="python keyword">for</code> <code class="python plain">i </code><code class="python keyword">in</code> <code class="python functions">range</code><code class="python plain">(</code><code class="python value">0</code><code class="python plain">, </code><code class="python functions">len</code><code class="python plain">(tvalues)):</code></div><div id="codeline" class="line number17 index16 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">pvalues.append(</code><code class="python functions">round</code><code class="python plain">(C </code><code class="python keyword">+</code> <code class="python plain">D </code><code class="python keyword">*</code> <code class="python plain">tvalues[i], </code><code class="python value">3</code><code class="python plain">))</code></div><div id="codeline" class="line number18 index17 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">errors.append(</code><code class="python functions">round</code><code class="python plain">(b[i] </code><code class="python keyword">-</code> <code class="python plain">pvalues[i], </code><code class="python value">3</code><code class="python plain">))</code></div><div id="codeline" class="line number19 index18 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code><code class="python plain">(f</code><code class="python string">'p = {pvalues[i]}, e = {errors[i]}, p + e = {round(pvalues[i] + errors[i], 3)}, b = {b[i]}'</code><code class="python plain">)</code></div><div id="codeline" class="line number20 index19 alt1">&nbsp;</div><div id="codeline" class="line number21 index20 alt2"><code class="python comments">#OUTPUT:</code></div><div id="codeline" class="line number22 index21 alt1"><code class="python comments">'''</code></div><div id="codeline" class="line number23 index22 alt2"><code class="python comments">p + e = b?</code></div><div id="codeline" class="line number24 index23 alt1"><code class="python comments">p = 1.167, e = -0.167, p + e = 1.0, b = 1</code></div><div id="codeline" class="line number25 index24 alt2"><code class="python comments">p = 1.667, e = 0.333, p + e = 2.0, b = 2</code></div><div id="codeline" class="line number26 index25 alt1"><code class="python comments">p = 2.167, e = -0.167, p + e = 2.0, b = 2</code></div><div id="codeline" class="line number27 index26 alt2"><code class="python comments">'''</code></div><div id="codeline" class="line number28 index27 alt1">&nbsp;</div><div id="codeline" class="line number29 index28 alt2"><code class="python comments"># Show that p and e are orthogonal</code></div><div id="codeline" class="line number30 index29 alt1">&nbsp;</div><div id="codeline" class="line number31 index30 alt2"><code class="python plain">p </code><code class="python keyword">=</code> <code class="python plain">np.array(pvalues)</code></div><div id="codeline" class="line number32 index31 alt1"><code class="python plain">e </code><code class="python keyword">=</code> <code class="python plain">np.array(errors)</code></div><div id="codeline" class="line number33 index32 alt2">&nbsp;</div><div id="codeline" class="line number34 index33 alt1"><code class="python functions">print</code><code class="python plain">(f</code><code class="python string">'p = \n{p}\ne = \n{e}\np dot e = \n{abs(round(np.dot(p, e), 2))} so p and e are orthogonal'</code><code class="python plain">)</code></div><div id="codeline" class="line number35 index34 alt2">&nbsp;</div><div id="codeline" class="line number36 index35 alt1"><code class="python comments">#OUTPUT:</code></div><div id="codeline" class="line number37 index36 alt2"><code class="python comments">'''</code></div><div id="codeline" class="line number38 index37 alt1"><code class="python comments">p =</code></div><div id="codeline" class="line number39 index38 alt2"><code class="python comments">[1.167 1.667 2.167]</code></div><div id="codeline" class="line number40 index39 alt1"><code class="python comments">e =</code></div><div id="codeline" class="line number41 index40 alt2"><code class="python comments">[-0.167&nbsp; 0.333 -0.167]</code></div><div id="codeline" class="line number42 index41 alt1"><code class="python comments">p dot e =</code></div><div id="codeline" class="line number43 index42 alt2"><code class="python comments">0.0 so p and e are orthogonal</code></div><div id="codeline" class="line number44 index43 alt1"><code class="python comments">'''</code></div></div></td></tr><tr><td>&nbsp;</td></tr><tr><td>&nbsp;</td></tr></tbody></table></div>
{% endblock code %}