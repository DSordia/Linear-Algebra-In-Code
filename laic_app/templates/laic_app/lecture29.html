{% extends 'laic_app/lecturebase.html' %}

{% block video %}
    <iframe width="560" height="315"
        src="https://www.youtube.com/embed/TX_vooSnhm8"
        frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
    </iframe>
{% endblock video %}

{% block keyIdeas %}
    <li>Singular Value Decomposition (SVD): a way of factorizing a matrix. A = UΣV<sup>T</sup>, where U and V<sup>T</sup> are orthogonal matrices and Σ is a diagonal matrix</li>
    <li>If the matrix A is positive-definite, then the SVD factorization is A = QΛQ<sup>T</sup>, where Q is the eigenvector matrix of A and Λ is Q<sup>-1</sup>AQ</li>
    <li>In SVD, the goal is to find an orthogonal basis for a vector in the row space that maps to an orthogonal basis for a vector in the column space</li>
    <li>Take orthonormal vectors in the row space v<sub>1</sub>, v<sub>2</sub>, ..., v<sub>r</sub> and orthornormal vectors in the column space
    u<sub>1</sub>, u<sub>2</sub>, ..., u<sub>r</sub> where σ<sub>1</sub>u<sub>1</sub>, σ<sub>2</sub>u<sub>2</sub>, ..., σ<sub>n</sub>u<sub>r</sub> = Av<sub>1</sub>, Av<sub>2</sub>, ..., Av<sub>r</sub>.
    This implies that AV = UΣ which implies A = UΣV<sup>T</sup>, (since V<sup>-1</sup> = V<sup>T</sup> for square, orthogonal matrices),
     where V is the vector v<sub>1</sub>, v<sub>2</sub>, ... v<sub>r</sub>, U is the vector u<sub>1</sub>, u<sub>2</sub>, ..., u<sub>r</sub> and Σ is a diagonal matrix
    with all zeros and σ<sub>1</sub>, σ<sub>2</sub>, ..., σ<sub>r</sub> on the diagonal
    </li>
    <li>Multiplying both sides by A<sup>T</sup>, A = UΣV<sup>T</sup> reduces to A<sup>T</sup>A = VΣ<sup>T</sup>V<sup>T</sup>, where V is the eigenvector matrix of A and 
    Σ is a diagonal matrix with all zeros and the square roots of the eigenvalues of A<sup>T</sup>A across the diagonal. To find U, do the same thing except
    multiply by A<sup>T</sup> on the right rather than the left. Note that Σ will be the same since the eigenvalues of A<sup>T</sup>A = the eigenvalues of AA<sup>T</sup></li>
{% endblock keyIdeas %}

{% block inCode %}
    <li>Showing that A = UΣV<sup>T</sup> for a 2x2 non-symmetric invertible matrix</li>
    <li>Showing that A = UΣV<sup>T</sup> for a 2x2 non-invertible matrix</li>
{% endblock inCode %}

{% block code %}
    <div id="highlighterMainDiv_944434" class="syntaxhighlighter nogutter python"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td>&nbsp;</td></tr><tr><td id="codeContainer_944434" class="code"><div id="container_944434" class="container"><div id="codeline" class="line number1 index0 alt2"><code class="python comments"># LECTURE 29 - Singular Value Decomposition</code></div><div id="codeline" class="line number2 index1 alt1">&nbsp;</div><div id="codeline" class="line number3 index2 alt2"><code class="python keyword">import</code> <code class="python plain">numpy as np</code></div><div id="codeline" class="line number4 index3 alt1">&nbsp;</div><div id="codeline" class="line number5 index4 alt2"><code class="python comments"># Showing that A = UEV^T for a 2x2 non-symmetric invertible matrix</code></div><div id="codeline" class="line number6 index5 alt1">&nbsp;</div><div id="codeline" class="line number7 index6 alt2"><code class="python plain">A </code><code class="python keyword">=</code> <code class="python plain">np.array([[</code><code class="python value">4</code><code class="python plain">, </code><code class="python value">4</code><code class="python plain">], [</code><code class="python keyword">-</code><code class="python value">3</code><code class="python plain">, </code><code class="python value">3</code><code class="python plain">]])</code></div><div id="codeline" class="line number8 index7 alt1">&nbsp;</div><div id="codeline" class="line number9 index8 alt2"><code class="python plain">ATA </code><code class="python keyword">=</code> <code class="python plain">np.dot(A.transpose(), A)</code></div><div id="codeline" class="line number10 index9 alt1"><code class="python plain">AAT </code><code class="python keyword">=</code> <code class="python plain">np.dot(A, A.transpose())</code></div><div id="codeline" class="line number11 index10 alt2">&nbsp;</div><div id="codeline" class="line number12 index11 alt1"><code class="python plain">evalues1, evectors1 </code><code class="python keyword">=</code> <code class="python plain">np.linalg.eig(ATA)</code></div><div id="codeline" class="line number13 index12 alt2"><code class="python plain">evalues2, evectors2 </code><code class="python keyword">=</code> <code class="python plain">np.linalg.eig(AAT)</code></div><div id="codeline" class="line number14 index13 alt1">&nbsp;</div><div id="codeline" class="line number15 index14 alt2"><code class="python plain">E </code><code class="python keyword">=</code> <code class="python plain">np.array([[np.sqrt(evalues1[</code><code class="python value">0</code><code class="python plain">]), </code><code class="python value">0</code><code class="python plain">], [</code><code class="python value">0</code><code class="python plain">, np.sqrt(evalues1[</code><code class="python value">1</code><code class="python plain">])]])</code></div><div id="codeline" class="line number16 index15 alt1">&nbsp;</div><div id="codeline" class="line number17 index16 alt2"><code class="python plain">U </code><code class="python keyword">=</code> <code class="python plain">evectors2</code></div><div id="codeline" class="line number18 index17 alt1"><code class="python plain">VT </code><code class="python keyword">=</code> <code class="python plain">evectors1.transpose()</code></div><div id="codeline" class="line number19 index18 alt2">&nbsp;</div><div id="codeline" class="line number20 index19 alt1"><code class="python functions">print</code><code class="python plain">(f</code><code class="python string">'A = \n{A}\nUEV^T = \n{np.dot(U, np.dot(E, VT))}'</code><code class="python plain">)</code></div><div id="codeline" class="line number21 index20 alt2">&nbsp;</div><div id="codeline" class="line number22 index21 alt1"><code class="python comments">#OUTPUT:</code></div><div id="codeline" class="line number23 index22 alt2"><code class="python comments">'''</code></div><div id="codeline" class="line number24 index23 alt1"><code class="python comments">A =</code></div><div id="codeline" class="line number25 index24 alt2"><code class="python comments">[[ 4&nbsp; 4]</code></div><div id="codeline" class="line number26 index25 alt1"><code class="python spaces">&nbsp;</code><code class="python comments">[-3&nbsp; 3]]</code></div><div id="codeline" class="line number27 index26 alt2"><code class="python comments">UEV^T =</code></div><div id="codeline" class="line number28 index27 alt1"><code class="python comments">[[ 4.&nbsp; 4.]</code></div><div id="codeline" class="line number29 index28 alt2"><code class="python spaces">&nbsp;</code><code class="python comments">[-3.&nbsp; 3.]]</code></div><div id="codeline" class="line number30 index29 alt1"><code class="python comments">'''</code></div><div id="codeline" class="line number31 index30 alt2">&nbsp;</div><div id="codeline" class="line number32 index31 alt1"><code class="python comments"># elegant way of doing SVD using NuMpy taken from <a href="https://stackoverflow.com/a/58523650/12733759">https://stackoverflow.com/a/58523650/12733759</a></code></div><div id="codeline" class="line number33 index32 alt2"><code class="python plain">U, D, V </code><code class="python keyword">=</code> <code class="python plain">np.linalg.svd(A, full_matrices </code><code class="python keyword">=</code> <code class="python color1">False</code><code class="python plain">)</code></div><div id="codeline" class="line number34 index33 alt1"><code class="python plain">A_reconstructed </code><code class="python keyword">=</code> <code class="python plain">U @ np.diag(D) @ V</code></div><div id="codeline" class="line number35 index34 alt2"><code class="python functions">print</code><code class="python plain">(A_reconstructed)</code></div><div id="codeline" class="line number36 index35 alt1">&nbsp;</div><div id="codeline" class="line number37 index36 alt2"><code class="python comments">#OUTPUT:</code></div><div id="codeline" class="line number38 index37 alt1"><code class="python comments">'''</code></div><div id="codeline" class="line number39 index38 alt2"><code class="python comments">[[ 4.&nbsp; 4.]</code></div><div id="codeline" class="line number40 index39 alt1"><code class="python spaces">&nbsp;</code><code class="python comments">[-3.&nbsp; 3.]]</code></div><div id="codeline" class="line number41 index40 alt2"><code class="python comments">'''</code></div><div id="codeline" class="line number42 index41 alt1">&nbsp;</div><div id="codeline" class="line number43 index42 alt2"><code class="python comments"># Showing that A = UEV^T for a 2x2 non-invertible matrix</code></div><div id="codeline" class="line number44 index43 alt1">&nbsp;</div><div id="codeline" class="line number45 index44 alt2"><code class="python plain">A </code><code class="python keyword">=</code> <code class="python plain">np.array([[</code><code class="python value">4</code><code class="python plain">, </code><code class="python value">3</code><code class="python plain">], [</code><code class="python value">8</code><code class="python plain">, </code><code class="python value">6</code><code class="python plain">]])</code></div><div id="codeline" class="line number46 index45 alt1">&nbsp;</div><div id="codeline" class="line number47 index46 alt2"><code class="python plain">ATA </code><code class="python keyword">=</code> <code class="python plain">np.dot(A.transpose(), A)</code></div><div id="codeline" class="line number48 index47 alt1"><code class="python plain">AAT </code><code class="python keyword">=</code> <code class="python plain">np.dot(A, A.transpose())</code></div><div id="codeline" class="line number49 index48 alt2">&nbsp;</div><div id="codeline" class="line number50 index49 alt1"><code class="python plain">evalues1, evectors1 </code><code class="python keyword">=</code> <code class="python plain">np.linalg.eig(ATA)</code></div><div id="codeline" class="line number51 index50 alt2"><code class="python plain">evalues2, evectors2 </code><code class="python keyword">=</code> <code class="python plain">np.linalg.eig(AAT)</code></div><div id="codeline" class="line number52 index51 alt1">&nbsp;</div><div id="codeline" class="line number53 index52 alt2"><code class="python plain">E </code><code class="python keyword">=</code> <code class="python plain">np.array([[np.sqrt(evalues1[</code><code class="python value">0</code><code class="python plain">]), </code><code class="python value">0</code><code class="python plain">], [</code><code class="python value">0</code><code class="python plain">, np.</code><code class="python functions">round</code><code class="python plain">(np.sqrt(evalues1[</code><code class="python value">1</code><code class="python plain">]))]])</code></div><div id="codeline" class="line number54 index53 alt1"><code class="python plain">U </code><code class="python keyword">=</code> <code class="python plain">evectors2</code></div><div id="codeline" class="line number55 index54 alt2"><code class="python plain">VT </code><code class="python keyword">=</code> <code class="python plain">evectors1.transpose()</code></div><div id="codeline" class="line number56 index55 alt1">&nbsp;</div><div id="codeline" class="line number57 index56 alt2"><code class="python functions">print</code><code class="python plain">(f</code><code class="python string">'A = \n{A}\nUEV^T = \n{np.dot(U, np.dot(E, VT))}'</code><code class="python plain">)</code></div><div id="codeline" class="line number58 index57 alt1">&nbsp;</div><div id="codeline" class="line number59 index58 alt2"><code class="python comments">#OUTPUT:</code></div><div id="codeline" class="line number60 index59 alt1"><code class="python comments">'''</code></div><div id="codeline" class="line number61 index60 alt2"><code class="python comments">A =</code></div><div id="codeline" class="line number62 index61 alt1"><code class="python comments">[[4 3]</code></div><div id="codeline" class="line number63 index62 alt2"><code class="python spaces">&nbsp;</code><code class="python comments">[8 6]]</code></div><div id="codeline" class="line number64 index63 alt1"><code class="python comments">UEV^T =</code></div><div id="codeline" class="line number65 index64 alt2"><code class="python comments">[[-8. -6.]</code></div><div id="codeline" class="line number66 index65 alt1"><code class="python spaces">&nbsp;</code><code class="python comments">[ 4.&nbsp; 3.]]</code></div><div id="codeline" class="line number67 index66 alt2"><code class="python comments">'''</code> <code class="python comments">#note that these two matrices are the same.. multiply row 1 by -1 and flip rows 1 and 2; these are valid row operations</code></div><div id="codeline" class="line number68 index67 alt1">&nbsp;</div><div id="codeline" class="line number69 index68 alt2"><code class="python comments"># elegant way of doing SVD using NuMpy taken from <a href="https://stackoverflow.com/a/58523650/12733759">https://stackoverflow.com/a/58523650/12733759</a></code></div><div id="codeline" class="line number70 index69 alt1"><code class="python plain">U, D, V </code><code class="python keyword">=</code> <code class="python plain">np.linalg.svd(A, full_matrices </code><code class="python keyword">=</code> <code class="python color1">False</code><code class="python plain">)</code></div><div id="codeline" class="line number71 index70 alt2"><code class="python plain">A_reconstructed </code><code class="python keyword">=</code> <code class="python plain">U @ np.diag(D) @ V</code></div><div id="codeline" class="line number72 index71 alt1"><code class="python functions">print</code><code class="python plain">(A_reconstructed)</code></div><div id="codeline" class="line number73 index72 alt2">&nbsp;</div><div id="codeline" class="line number74 index73 alt1"><code class="python comments">#OUTPUT:</code></div><div id="codeline" class="line number75 index74 alt2"><code class="python comments">'''</code></div><div id="codeline" class="line number76 index75 alt1"><code class="python comments">[[4. 3.]</code></div><div id="codeline" class="line number77 index76 alt2"><code class="python spaces">&nbsp;</code><code class="python comments">[8. 6.]]</code></div><div id="codeline" class="line number78 index77 alt1"><code class="python comments">'''</code></div></div></td></tr><tr><td>&nbsp;</td></tr><tr><td>&nbsp;</td></tr></tbody></table></div>
{% endblock code %}