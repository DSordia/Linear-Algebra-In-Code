{% extends 'laic_app/lecturebase.html' %}

{% block video %}
    <iframe width="560" height="315"
        src="https://www.youtube.com/embed/Go2aLo7ZOlU"
        frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
    </iframe>
{% endblock video %}

{% block keyIdeas %}
    <li>2-sided (regular) inverse: AA<sup>-1</sup> = I = A<sup>-1</sup>A, where A is an invertible m x n matrix and r = m = n</li>
    <li>Left inverse: full column rank, all of the columns are linearly independent, r = n < m, the null space only consists of the 0 vector, Ax = b has 0 or 1 solutions, 
        and (A<sup>T</sup>A)<sup>-1</sup>A<sup>T</sup>A = I, which implies A<sup>-1</sup><sub>left</sub> = (A<sup>T</sup>A)<sup>-1</sup>A<sup>T</sup> and A<sup>-1</sup><sub>left</sub>
        (n x m) A (m x n) = I (n x n)
    </li>
    <li>Right inverse: full row rank, all of the rows are linearly independent, r = m < n, the left null space only consists of the 0 vector, Ax = b has infinitely many solutions,
    and AA<sup>T</sup>(AA<sup>T</sup>)<sup>-1</sup> = I which implies A<sup>-1</sup><sub>right</sub> = A<sup>T</sup>(AA<sup>T</sup>)<sup>-1</sup> and AA<sup>-1</sup><sub>right</sub> = I</li>
    <li>Pseudoinverse: Let x, y be unique vectors in the row space. Then there is some matrix A for which Ax and Ay are in the column space (where Ax &#8800 Ay). The 
        pseudoinverse A<sup>+</sup> = (A<sup>T</sup>A)<sup>-1</sup>A<sup>T</sup> is the matrix which takes Ax and Ay from the column space back to the row space
        (so y = A<sup>+</sup>(Ay) and x = A<sup>+</sup>(Ax)) and A<sup>+</sup>A = I
    </li>
    <li>Finding the pseudoinverse: recall from SVD that we have A = UΣV<sup>T</sup> where Σ is an m x n matrix of all 0s with σ<sub>1</sub>, σ<sub>2</sub>, ..., σ<sub>r</sub>
        on the diagonal and rank r. Then Σ<sup>+</sup> is a diagonal n x m matrix with all 0s with 1/σ<sub>1</sub>, 1/σ<sub>2</sub>, ..., 1/σ<sub>r</sub> on the diagonal.
        This implies that ΣΣ<sup>+</sup> is an m x m matrix with all 0s with 1s on the diagonal (the projection onto the column space) 
        and Σ<sup>+</sup>Σ is an n x n matrix with all 0s with 1s on the diagonal (the projection onto the row space). Now that we have Σ<sup>+</sup>, we have that
        A<sup>+</sup> = VΣ<sup>+</sup>U<sup>T</sup></li>
{% endblock keyIdeas %}

{% block inCode %}
    <li>Left inverse of a matrix</li>
    <li>Right inverse of a matrix</li>
    <li>Pseudoinverse of a matrix</li>
{% endblock inCode %}

{% block code %}
    <div id="highlighterMainDiv_441511" class="syntaxhighlighter nogutter python"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td>&nbsp;</td></tr><tr><td id="codeContainer_441511" class="code"><div id="container_441511" class="container"><div id="codeline" class="line number1 index0 alt2"><code class="python comments"># LECTURE 33 - Left and Right Inverses; Pseudoinverse</code></div><div id="codeline" class="line number2 index1 alt1">&nbsp;</div><div id="codeline" class="line number3 index2 alt2"><code class="python keyword">import</code> <code class="python plain">numpy as np</code></div><div id="codeline" class="line number4 index3 alt1"><code class="python keyword">from</code> <code class="python plain">sympy </code><code class="python keyword">import</code> <code class="python keyword">*</code></div><div id="codeline" class="line number5 index4 alt2">&nbsp;</div><div id="codeline" class="line number6 index5 alt1"><code class="python comments"># Left inverse of a matrix</code></div><div id="codeline" class="line number7 index6 alt2">&nbsp;</div><div id="codeline" class="line number8 index7 alt1"><code class="python plain">A </code><code class="python keyword">=</code> <code class="python plain">Matrix([[</code><code class="python value">1</code><code class="python plain">, </code><code class="python value">3</code><code class="python plain">], [</code><code class="python value">2</code><code class="python plain">, </code><code class="python value">1</code><code class="python plain">], [</code><code class="python value">6</code><code class="python plain">, </code><code class="python value">1</code><code class="python plain">], [</code><code class="python value">5</code><code class="python plain">, </code><code class="python value">1</code><code class="python plain">]])</code></div><div id="codeline" class="line number9 index8 alt2"><code class="python plain">LeftInverse </code><code class="python keyword">=</code> <code class="python plain">((A.T </code><code class="python keyword">*</code> <code class="python plain">A)</code><code class="python keyword">*</code><code class="python keyword">*</code><code class="python keyword">-</code><code class="python value">1</code><code class="python plain">) </code><code class="python keyword">*</code> <code class="python plain">A.T</code></div><div id="codeline" class="line number10 index9 alt1">&nbsp;</div><div id="codeline" class="line number11 index10 alt2"><code class="python functions">print</code><code class="python plain">(f</code><code class="python string">'A = \n{A}\nDimensions of A = \n{A.shape}\nRank of A = \n{A.rank()}\nNull space of A = \n{A.nullspace()}'</code></div><div id="codeline" class="line number12 index11 alt1"><code class="python plain">f</code><code class="python string">'\nLeft inverse of A = (ATA)^-1*AT = \n{LeftInverse}\nLeft inverse * A = \n{LeftInverse * A}'</code><code class="python plain">)</code></div><div id="codeline" class="line number13 index12 alt2">&nbsp;</div><div id="codeline" class="line number14 index13 alt1"><code class="python comments">#OUTPUT:</code></div><div id="codeline" class="line number15 index14 alt2"><code class="python comments">'''</code></div><div id="codeline" class="line number16 index15 alt1"><code class="python comments">A =</code></div><div id="codeline" class="line number17 index16 alt2"><code class="python comments">Matrix([[1, 3], [2, 1], [6, 1], [5, 1]])</code></div><div id="codeline" class="line number18 index17 alt1"><code class="python comments">Dimensions of A =</code></div><div id="codeline" class="line number19 index18 alt2"><code class="python comments">(4, 2)</code></div><div id="codeline" class="line number20 index19 alt1"><code class="python comments">Rank of A =</code></div><div id="codeline" class="line number21 index20 alt2"><code class="python comments">2</code></div><div id="codeline" class="line number22 index21 alt1"><code class="python comments">Null space of A =</code></div><div id="codeline" class="line number23 index22 alt2"><code class="python comments">[]</code></div><div id="codeline" class="line number24 index23 alt1"><code class="python comments">Left inverse of A = (ATA)^-1*AT =</code></div><div id="codeline" class="line number25 index24 alt2"><code class="python comments">Matrix([[-9/134, 1/67, 7/67, 11/134], [91/268, 17/268, -15/268, -7/268]])</code></div><div id="codeline" class="line number26 index25 alt1"><code class="python comments">Left inverse * A =</code></div><div id="codeline" class="line number27 index26 alt2"><code class="python comments">Matrix([[1, 0], [0, 1]])</code></div><div id="codeline" class="line number28 index27 alt1"><code class="python comments">'''</code></div><div id="codeline" class="line number29 index28 alt2">&nbsp;</div><div id="codeline" class="line number30 index29 alt1"><code class="python comments"># Right inverse of a matrix</code></div><div id="codeline" class="line number31 index30 alt2">&nbsp;</div><div id="codeline" class="line number32 index31 alt1"><code class="python plain">A </code><code class="python keyword">=</code> <code class="python plain">Matrix([[</code><code class="python value">1</code><code class="python plain">, </code><code class="python value">2</code><code class="python plain">, </code><code class="python value">6</code><code class="python plain">, </code><code class="python value">5</code><code class="python plain">], [</code><code class="python value">3</code><code class="python plain">, </code><code class="python value">1</code><code class="python plain">, </code><code class="python value">1</code><code class="python plain">, </code><code class="python value">1</code><code class="python plain">]])</code></div><div id="codeline" class="line number33 index32 alt2"><code class="python plain">RightInverse </code><code class="python keyword">=</code> <code class="python plain">A.T </code><code class="python keyword">*</code> <code class="python plain">((A </code><code class="python keyword">*</code> <code class="python plain">A.T))</code><code class="python keyword">*</code><code class="python keyword">*</code><code class="python keyword">-</code><code class="python value">1</code></div><div id="codeline" class="line number34 index33 alt1">&nbsp;</div><div id="codeline" class="line number35 index34 alt2"><code class="python functions">print</code><code class="python plain">(f</code><code class="python string">'A = \n{A}\nDimensions of A = \n{A.shape}\nRank of A = \n{A.rank()}\nLeft Null space of A = \n{A.T.nullspace()}'</code></div><div id="codeline" class="line number36 index35 alt1"><code class="python plain">f</code><code class="python string">'\nRight inverse of A = AT(AAT)^-1 = \n{RightInverse}\nA * Right inverse = \n{A * RightInverse}'</code><code class="python plain">)</code></div><div id="codeline" class="line number37 index36 alt2">&nbsp;</div><div id="codeline" class="line number38 index37 alt1"><code class="python comments">#OUTPUT:</code></div><div id="codeline" class="line number39 index38 alt2"><code class="python comments">'''</code></div><div id="codeline" class="line number40 index39 alt1"><code class="python comments">A =</code></div><div id="codeline" class="line number41 index40 alt2"><code class="python comments">Matrix([[1, 2, 6, 5], [3, 1, 1, 1]])</code></div><div id="codeline" class="line number42 index41 alt1"><code class="python comments">Dimensions of A =</code></div><div id="codeline" class="line number43 index42 alt2"><code class="python comments">(2, 4)</code></div><div id="codeline" class="line number44 index43 alt1"><code class="python comments">Rank of A =</code></div><div id="codeline" class="line number45 index44 alt2"><code class="python comments">2</code></div><div id="codeline" class="line number46 index45 alt1"><code class="python comments">Left Null space of A =</code></div><div id="codeline" class="line number47 index46 alt2"><code class="python comments">[]</code></div><div id="codeline" class="line number48 index47 alt1"><code class="python comments">Right inverse of A = AT(AAT)^-1 =</code></div><div id="codeline" class="line number49 index48 alt2"><code class="python comments">Matrix([[-9/134, 91/268], [1/67, 17/268], [7/67, -15/268], [11/134, -7/268]])</code></div><div id="codeline" class="line number50 index49 alt1"><code class="python comments">A * Right inverse =</code></div><div id="codeline" class="line number51 index50 alt2"><code class="python comments">Matrix([[1, 0], [0, 1]])</code></div><div id="codeline" class="line number52 index51 alt1"><code class="python comments">'''</code></div><div id="codeline" class="line number53 index52 alt2">&nbsp;</div><div id="codeline" class="line number54 index53 alt1"><code class="python comments">#Pseudoinverse of a matrix</code></div><div id="codeline" class="line number55 index54 alt2">&nbsp;</div><div id="codeline" class="line number56 index55 alt1"><code class="python plain">A </code><code class="python keyword">=</code> <code class="python plain">np.array([[</code><code class="python value">1</code><code class="python plain">, </code><code class="python value">3</code><code class="python plain">], [</code><code class="python value">5</code><code class="python plain">, </code><code class="python value">7</code><code class="python plain">], [</code><code class="python value">11</code><code class="python plain">, </code><code class="python value">13</code><code class="python plain">]])</code></div><div id="codeline" class="line number57 index56 alt2">&nbsp;</div><div id="codeline" class="line number58 index57 alt1"><code class="python plain">PseudoInverse </code><code class="python keyword">=</code> <code class="python plain">np.linalg.pinv(A)</code></div><div id="codeline" class="line number59 index58 alt2">&nbsp;</div><div id="codeline" class="line number60 index59 alt1"><code class="python functions">print</code><code class="python plain">(f</code><code class="python string">'A = \n{A}\nPseudoinverse of A = \n{PseudoInverse}\nA+ * A = \n{np.dot(PseudoInverse, A)}'</code><code class="python plain">)</code></div><div id="codeline" class="line number61 index60 alt2">&nbsp;</div><div id="codeline" class="line number62 index61 alt1"><code class="python comments">#OUTPUT:</code></div><div id="codeline" class="line number63 index62 alt2"><code class="python comments">'''</code></div><div id="codeline" class="line number64 index63 alt1"><code class="python comments">A =</code></div><div id="codeline" class="line number65 index64 alt2"><code class="python comments">[[ 1&nbsp; 3]</code></div><div id="codeline" class="line number66 index65 alt1"><code class="python spaces">&nbsp;</code><code class="python comments">[ 5&nbsp; 7]</code></div><div id="codeline" class="line number67 index66 alt2"><code class="python spaces">&nbsp;</code><code class="python comments">[11 13]]</code></div><div id="codeline" class="line number68 index67 alt1"><code class="python comments">Pseudoinverse of A =</code></div><div id="codeline" class="line number69 index68 alt2"><code class="python comments">[[-0.51973684 -0.21710526&nbsp; 0.23684211]</code></div><div id="codeline" class="line number70 index69 alt1"><code class="python spaces">&nbsp;</code><code class="python comments">[ 0.42763158&nbsp; 0.20394737 -0.13157895]]</code></div><div id="codeline" class="line number71 index70 alt2"><code class="python comments">A+ * A =</code></div><div id="codeline" class="line number72 index71 alt1"><code class="python comments">[[1.00000000e+00 1.02695630e-15]</code></div><div id="codeline" class="line number73 index72 alt2"><code class="python spaces">&nbsp;</code><code class="python comments">[1.91513472e-15 1.00000000e+00]]</code></div><div id="codeline" class="line number74 index73 alt1"><code class="python comments">'''</code> <code class="python comments"># note A+ * A is the identity matrix</code></div></div></td></tr><tr><td>&nbsp;</td></tr><tr><td>&nbsp;</td></tr></tbody></table></div>
{% endblock code %}