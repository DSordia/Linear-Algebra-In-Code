{% extends 'laic_app/lecturebase.html' %}

{% block video %}
    <iframe width="560" height="315"
        src="https://www.youtube.com/embed/IZqwi0wJovM"
        frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
    </iframe>
{% endblock video %}

{% block keyIdeas %}
    <li>General solution to a differential equation with 2 eigenvalues: u(t) = c<sub>1</sub>e<sup>λ<sub>1</sub>t</sup>x<sub>1</sub> + c<sub>2</sub>e<sup>λ<sub>2</sub>t</sup>x<sub>2</sub>.
    Plug in known values and solve for c<sub>1</sub> and c<sub>2</sub> and plug them back in</li>
    <li>u(t) approaches 0 if the eigenvalue is less than 0 (if the eigenvalue is a complex root, only consider the real part)</li>
    <li>A steady state is present when one eigenvalue is 0 and the rest are negative</li>
    <li>A 2x2 matrix will always be stable (u(t) --> 0) if the trace is less than 0 and the determinant is greater than 0</li>
    <li>Take du/dt = Au. Now let u be the set Sv, where S is the matrix of eigenvectors, which implies dv / dt = S<sup>-1</sup>ASv = Λv,
    which implies u(t) = Se<sup>Λt</sup>S<sup>-1</sup>u(0) = e<sup>At</sup>u(0)</li>
    <li>Matrix exponential: e<sup>At</sup> = I + At + (At)<sup>2</sup> / 2 + ... + (At)<sup>2</sup> / n!
    = I + SΛS<sup>-1</sup>t + SΛ<sup>2</sup>S<sup>-1</sup>t<sup>2</sup> / 2 + ... + SΛ<sup>n</sup>S<sup>-1</sup>t<sup>n</sup>
    = Se<sup>Λt</sup>S<sup>-1</sup>. Note: this equation only works if A is diagonalizable</li>
    <li>e<sup>Λt</sup> is a matrix with all 0s and e<sup>λ<sub>n</sub>t</sup> on the diagonal</li>
{% endblock keyIdeas %}

{% block inCode %}
    <li>Solving a 2-equation differential equation</li>
{% endblock inCode %}

{% block code %}
    <div id="highlighterMainDiv_403600" class="syntaxhighlighter nogutter python"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td>&nbsp;</td></tr><tr><td id="codeContainer_403600" class="code"><div id="container_403600" class="container"><div id="codeline" class="line number1 index0 alt2"><code class="python comments"># LECTURE 23 - Differential Equations and exp(At)</code></div><div id="codeline" class="line number2 index1 alt1">&nbsp;</div><div id="codeline" class="line number3 index2 alt2"><code class="python keyword">import</code> <code class="python plain">numpy as np</code></div><div id="codeline" class="line number4 index3 alt1"><code class="python keyword">from</code> <code class="python plain">sympy </code><code class="python keyword">import</code> <code class="python keyword">*</code></div><div id="codeline" class="line number5 index4 alt2">&nbsp;</div><div id="codeline" class="line number6 index5 alt1"><code class="python comments"># Solving a 2-equation differential equation</code></div><div id="codeline" class="line number7 index6 alt2">&nbsp;</div><div id="codeline" class="line number8 index7 alt1"><code class="python comments">#du/dt = -u1 + 2u2</code></div><div id="codeline" class="line number9 index8 alt2"><code class="python comments">#du/dt = u1 - 2u2</code></div><div id="codeline" class="line number10 index9 alt1"><code class="python comments">#u(0) = [1, 0]</code></div><div id="codeline" class="line number11 index10 alt2">&nbsp;</div><div id="codeline" class="line number12 index11 alt1"><code class="python plain">A </code><code class="python keyword">=</code> <code class="python plain">Matrix([[</code><code class="python keyword">-</code><code class="python value">1</code><code class="python plain">, </code><code class="python value">2</code><code class="python plain">], [</code><code class="python value">1</code><code class="python plain">, </code><code class="python keyword">-</code><code class="python value">2</code><code class="python plain">]])</code></div><div id="codeline" class="line number13 index12 alt2"><code class="python plain">evalues </code><code class="python keyword">=</code> <code class="python plain">A.eigenvals(); evectors </code><code class="python keyword">=</code> <code class="python plain">A.eigenvects()</code></div><div id="codeline" class="line number14 index13 alt1"><code class="python plain">x1 </code><code class="python keyword">=</code> <code class="python plain">evectors[</code><code class="python value">1</code><code class="python plain">]</code></div><div id="codeline" class="line number15 index14 alt2"><code class="python plain">x2 </code><code class="python keyword">=</code> <code class="python plain">evectors[</code><code class="python value">0</code><code class="python plain">]</code></div><div id="codeline" class="line number16 index15 alt1">&nbsp;</div><div id="codeline" class="line number17 index16 alt2"><code class="python comments">#solution: u(t) = c1e^lamda1t * x1 + cse^lamda2t * x2</code></div><div id="codeline" class="line number18 index17 alt1"><code class="python comments"># lamda1 is 0, so u(t) = c1 * x1 + c2 * e^-3t * x2</code></div><div id="codeline" class="line number19 index18 alt2"><code class="python comments"># initial condition: u(0) = [1, 0]</code></div><div id="codeline" class="line number20 index19 alt1">&nbsp;</div><div id="codeline" class="line number21 index20 alt2"><code class="python comments"># c1[2, 1] + c2[1, -1] = [1, 0]: construct a matrix</code></div><div id="codeline" class="line number22 index21 alt1">&nbsp;</div><div id="codeline" class="line number23 index22 alt2"><code class="python plain">A </code><code class="python keyword">=</code> <code class="python plain">np.array([[</code><code class="python value">2</code><code class="python plain">, </code><code class="python value">1</code><code class="python plain">], [</code><code class="python value">1</code><code class="python plain">, </code><code class="python keyword">-</code><code class="python value">1</code><code class="python plain">]])</code></div><div id="codeline" class="line number24 index23 alt1"><code class="python plain">b </code><code class="python keyword">=</code> <code class="python plain">np.array([[</code><code class="python value">1</code><code class="python plain">], [</code><code class="python value">0</code><code class="python plain">]])</code></div><div id="codeline" class="line number25 index24 alt2"><code class="python plain">solution </code><code class="python keyword">=</code> <code class="python plain">np.linalg.solve(A, b)</code></div><div id="codeline" class="line number26 index25 alt1">&nbsp;</div><div id="codeline" class="line number27 index26 alt2"><code class="python functions">print</code><code class="python plain">(f</code><code class="python string">'c1 and c2 are \n{solution}'</code><code class="python plain">)</code></div><div id="codeline" class="line number28 index27 alt1">&nbsp;</div><div id="codeline" class="line number29 index28 alt2"><code class="python comments">#OUTPUT:</code></div><div id="codeline" class="line number30 index29 alt1"><code class="python comments">'''</code></div><div id="codeline" class="line number31 index30 alt2"><code class="python comments">c1 and c2 are</code></div><div id="codeline" class="line number32 index31 alt1"><code class="python comments">[[0.33333333]</code></div><div id="codeline" class="line number33 index32 alt2"><code class="python spaces">&nbsp;</code><code class="python comments">[0.33333333]]</code></div><div id="codeline" class="line number34 index33 alt1"><code class="python comments">'''</code><code class="python comments"># so solution is u(t) = 1/3[2, 1] + 1/3e^-3t[1, -1]</code></div></div></td></tr><tr><td>&nbsp;</td></tr><tr><td>&nbsp;</td></tr></tbody></table></div>
{% endblock code %}